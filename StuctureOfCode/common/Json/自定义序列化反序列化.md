å¾ˆå¥½ï¼Œè¿™ä¸€å¥é—®å¾—ç‰¹åˆ«å‡† ğŸ‘
ä½ ç°åœ¨é—®çš„æ˜¯ï¼šâ€œè‡ªå®šä¹‰åºåˆ—åŒ– / ååºåˆ—åŒ–æ˜¯æ€ä¹ˆå®šä¹‰å‡ºæ¥çš„ï¼Ÿâ€

æ ¸å¿ƒå°±ä¸¤æ­¥ï¼š

â¸»

âœ… ç¬¬ä¸€æ­¥ï¼šå†™â€œè‡ªå®šä¹‰ç±»â€â€”â€”å®šä¹‰è§„åˆ™

ğŸ“ è‡ªå®šä¹‰åºåˆ—åŒ–ï¼ˆJava â†’ JSONï¼‰

ä¾‹å¦‚ï¼šæ‰‹æœºå·è„±æ•
```
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;

import java.io.IOException;

public class PhoneSerializer extends JsonSerializer<String> {

    @Override
    public void serialize(String value, JsonGenerator gen, SerializerProvider serializers)
            throws IOException {

        // è‡ªå®šä¹‰é€»è¾‘ï¼šä¸­é—´4ä½å˜æˆ****
        String masked = value.replaceAll("(\\d{3})\\d{4}(\\d{4})", "$1****$2");

        gen.writeString(masked);
    }
}
```
ğŸ“Œ è¿™å°±å«â€œå®šä¹‰åºåˆ—åŒ–è§„åˆ™â€

â¸»

ğŸ“ è‡ªå®šä¹‰ååºåˆ—åŒ–ï¼ˆJSON â†’ Javaï¼‰

ä¾‹å¦‚ï¼šæŠŠ "YES"/"NO" è½¬æˆ true/false
```
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.JsonDeserializer;

import java.io.IOException;

public class YesNoBooleanDeserializer extends JsonDeserializer<Boolean> {

    @Override
    public Boolean deserialize(JsonParser p, DeserializationContext ctxt)
            throws IOException {

        String text = p.getText();

        return "YES".equalsIgnoreCase(text);
    }
}
```
ğŸ“Œ è¿™å°±å«â€œå®šä¹‰ååºåˆ—åŒ–è§„åˆ™â€

â¸»

âœ… ç¬¬äºŒæ­¥ï¼šæ³¨å†Œåˆ° SimpleModule
```
SimpleModule module = new SimpleModule();

module.addSerializer(String.class, new PhoneSerializer());

module.addDeserializer(Boolean.class, new YesNoBooleanDeserializer());

```
â¸»

âœ… ç¬¬ä¸‰æ­¥ï¼šæ³¨å†Œåˆ° ObjectMapper

```this.registerModule(module);```

è¿™å°±æ˜¯ï¼š

ğŸ‘‰ â€œè‡ªå®šä¹‰é€»è¾‘æ˜¯æ€ä¹ˆå®šä¹‰å‡ºæ¥çš„â€
ğŸ‘‰ ä½ åˆšæ‰çœ‹åˆ°é‚£æ®µ LocalDateTime ä»£ç ï¼Œæœ¬è´¨ ä¹Ÿæ˜¯è¿™æ ·å®šä¹‰çš„

â¸»

ğŸ¯ ä½ å½“å‰é¡¹ç›®é‡Œçš„å®šä¹‰å±äºå“ªç§ï¼Ÿ

- âœ”  è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼åºåˆ—åŒ–å™¨
- âœ”  è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼ååºåˆ—åŒ–å™¨
- âœ”  æ³¨å†Œåˆ° JacksonObjectMapper
- âœ”  é€šè¿‡ MessageConverter å…¨å±€ç”Ÿæ•ˆ

éå¸¸æ ‡å‡†çš„ä¼ä¸šåç«¯å®è·µã€‚

â¸»

ğŸ§­ å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ ï¼š

ä½ é€‰ä¸€ä¸ªğŸ‘‡

- 1ï¸âƒ£ æˆ‘å¸®ä½ å†™ã€é‡‘é¢ä¿ç•™ä¸¤ä½å°æ•°ã€‘åºåˆ—åŒ–å™¨
- 2ï¸âƒ£ æˆ‘å¸®ä½ å†™ã€å¯†ç å­—æ®µè‡ªåŠ¨è„±æ•ã€‘åºåˆ—åŒ–å™¨
- 3ï¸âƒ£ ç”»å›¾è§£é‡Šï¼šè¯·æ±‚ JSON æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥è¿›åç«¯çš„
- 4ï¸âƒ£ é¢è¯•å›ç­”ï¼šä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰ ObjectMapper
- 5ï¸âƒ£ æ”¹é€ ä½ çš„é¡¹ç›®æ”¯æŒ ç»Ÿä¸€æ—¶åŒºï¼ˆé¿å…è·¨å›½æ—¶é—´é”™ä¹±ï¼‰


å¥½ï¼Œå…¨éƒ¨ç»™ä½ å®‰æ’ä¸Š âœ…ï¼Œç»Ÿä¸€ç”¨ **Markdown**ï¼Œç›´æ¥èƒ½ä¸¢è¿› GitHub / ç¬”è®°ã€‚

---

## 1ï¸âƒ£ ã€é‡‘é¢ä¿ç•™ä¸¤ä½å°æ•°ã€‘åºåˆ—åŒ–å™¨

### ğŸ’» è‡ªå®šä¹‰ Serializerï¼ˆBigDecimal â†’ ä¿ç•™ä¸¤ä½ï¼‰

```java
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;

import java.io.IOException;
import java.math.BigDecimal;
import java.math.RoundingMode;

public class BigDecimalTwoScaleSerializer extends JsonSerializer<BigDecimal> {

    @Override
    public void serialize(BigDecimal value, JsonGenerator gen, SerializerProvider serializers)
            throws IOException {
        if (value == null) {
            gen.writeNull();
            return;
        }
        BigDecimal scaled = value.setScale(2, RoundingMode.HALF_UP);
        // ç”¨å­—ç¬¦ä¸²è¾“å‡ºï¼Œé¿å…ç§‘å­¦è®¡æ•°æ³•
        gen.writeString(scaled.toString());
    }
}
```

### ğŸ“Œ å­—æ®µä¸Šä½¿ç”¨

```java
import com.fasterxml.jackson.databind.annotation.JsonSerialize;

public class OrderDTO {

    @JsonSerialize(using = BigDecimalTwoScaleSerializer.class)
    private BigDecimal amount;

    // getter / setter ...
}
```

---

## 2ï¸âƒ£ ã€å¯†ç å­—æ®µè‡ªåŠ¨è„±æ•ã€‘åºåˆ—åŒ–å™¨

### ğŸ’» è‡ªå®šä¹‰ Password Serializer

```java
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;

import java.io.IOException;

public class PasswordMaskSerializer extends JsonSerializer<String> {

    @Override
    public void serialize(String value, JsonGenerator gen, SerializerProvider serializers)
            throws IOException {
        if (value == null) {
            gen.writeNull();
            return;
        }
        // æ— è®ºçœŸå®å¯†ç æ˜¯ä»€ä¹ˆï¼Œéƒ½åªè¾“å‡ºå›ºå®šæ©ç 
        gen.writeString("******");
    }
}
```

### ğŸ“Œ åœ¨å®ä½“ä¸Šä½¿ç”¨

```java
import com.fasterxml.jackson.databind.annotation.JsonSerialize;

public class UserDTO {

    private String username;

    @JsonSerialize(using = PasswordMaskSerializer.class)
    private String password;

    // getter / setter ...
}
```

> è¡¥å……ï¼šæœ‰æ—¶ä¹Ÿä¼šåŒæ—¶åŠ  `@JsonProperty(access = JsonProperty.Access.WRITE_ONLY)`ï¼Œåªå…è®¸å‰ç«¯ä¼ å…¥ï¼Œä¸è¿”å›ç»™å‰ç«¯ã€‚

---

## 3ï¸âƒ£ è¯·æ±‚ JSON æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥è¿›åç«¯çš„ï¼ˆå›¾ + æ–‡å­—ï¼‰

### ğŸ” Mermaid æ—¶åºå›¾ï¼ˆå¯ç›´æ¥æ”¾ READMEï¼‰

```mermaid
sequenceDiagram
    participant C as Client (Browser / App)
    participant S as Spring MVC
    participant J as Jackson ObjectMapper
    participant B as Business Service
    participant D as Database

    C->>S: HTTP Request (JSON Body)
    S->>J: éœ€è¦æŠŠ JSON è½¬æˆ Java å¯¹è±¡
    J-->>S: å·²ååºåˆ—åŒ–çš„ Java DTO
    S->>B: è°ƒç”¨ Service(ä¼ å…¥ DTO)
    B->>D: è¯»å†™æ•°æ®åº“
    D-->>B: è¿”å›æ•°æ®
    B-->>S: è¿”å›ä¸šåŠ¡ç»“æœå¯¹è±¡
    S->>J: éœ€è¦æŠŠ Java å¯¹è±¡è½¬æˆ JSON
    J-->>S: å“åº” JSON
    S-->>C: HTTP Response (JSON)
```

### ğŸ§  ä¸€å¥è¯è®²æ¸…æ¥š

* è¿›æ¥æ—¶ï¼š**JSON â†’ Jackson â†’ Java å¯¹è±¡**
* å‡ºå»æ—¶ï¼š**Java å¯¹è±¡ â†’ Jackson â†’ JSON**
* ä½ è‡ªå®šä¹‰çš„åºåˆ—åŒ–å™¨ / ååºåˆ—åŒ–å™¨ = åœ¨è¿™ä¸¤æ­¥ä¸­â€œæ‹¦ä¸€æ‰‹åšè½¬æ¢é€»è¾‘â€

---

## 4ï¸âƒ£ é¢è¯•å›ç­”ï¼šä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰ ObjectMapperï¼ˆè‹±æ–‡ï¼‰

ä½ å¯ä»¥ç›´æ¥èƒŒè¿™æ®µğŸ‘‡

```text
In my projects I usually customize the ObjectMapper instead of using the default settings.

There are three main reasons:

First, I want full control over date and time formats, for example using "yyyy-MM-dd HH:mm" instead of the ISO default, so that the API payload is consistent with business requirements.

Second, I often add custom serializers and deserializers, such as masking password fields in JSON output or formatting amounts to two decimal places. Doing this centrally in ObjectMapper keeps my controllers and DTOs clean.

Third, I can configure global behaviors like time zone, property naming strategy, and unknown property handling. Overall, a customized ObjectMapper helps me keep JSON contracts stable, improves readability for clients, and reduces boilerplate logic scattered across the codebase.
```

å¦‚æœè¦ä¸­æ–‡é€Ÿè®°ç‰ˆï¼š

* æ§åˆ¶æ—¶é—´æ ¼å¼
* æ§åˆ¶é‡‘é¢ã€å¯†ç ç­‰åºåˆ—åŒ–é€»è¾‘
* ç»Ÿä¸€æ—¶åŒºã€å‘½åé£æ ¼ã€æœªçŸ¥å­—æ®µå¤„ç†
  ğŸ‘‰ â€œ**è®© JSON è§„åˆ™ç»Ÿä¸€ã€åç«¯ä»£ç æ›´å¹²å‡€**â€ã€‚

---

## 5ï¸âƒ£ æ”¹é€ é¡¹ç›®æ”¯æŒç»Ÿä¸€æ—¶åŒºï¼ˆé¿å…è·¨å›½æ—¶é—´é”™ä¹±ï¼‰

### ğŸ¯ ç›®æ ‡

* æ•°æ®åº“å­˜ **UTC**
* åç«¯ç”¨ **ç»Ÿä¸€æ—¶åŒºï¼ˆé€šå¸¸ UTCï¼‰**
* å‰ç«¯æŒ‰ç”¨æˆ·æ‰€åœ¨æ—¶åŒºå±•ç¤º

---

### ğŸ›  Spring Boot é…ç½®ç¤ºä¾‹ï¼ˆapplication.ymlï¼‰

```yaml
spring:
  jackson:
    time-zone: UTC
    date-format: yyyy-MM-dd'T'HH:mm:ss.SSS'Z'
```

### ğŸ›  å¯åŠ¨æ—¶è®¾ç½® JVM é»˜è®¤æ—¶åŒºï¼ˆå¯é€‰ï¼‰

```java
import jakarta.annotation.PostConstruct;
import org.springframework.stereotype.Component;

import java.util.TimeZone;

@Component
public class TimeZoneConfig {

    @PostConstruct
    public void init() {
        TimeZone.setDefault(TimeZone.getTimeZone("UTC"));
    }
}
```

> è¿™æ ·åšçš„æ•ˆæœï¼š
>
> * æ‰€æœ‰ `LocalDateTime` â†’ JSON æ—¶ï¼Œéƒ½æŒ‰ UTC è¾“å‡º
> * è·¨å›½éƒ¨ç½²æ—¶ï¼Œåç«¯ä¸ä¼šå› ä¸ºæœåŠ¡å™¨æ—¶åŒºä¸åŒè€Œâ€œæ—¶é—´é£˜æ¥é£˜å»â€

---

### ğŸ“Œ å°å¯¹ç…§è¡¨ï¼ˆå¯ä»¥æ”¾åˆ°ç¬”è®°é‡Œï¼‰

```markdown
| å±‚çº§ | å»ºè®®åšæ³• |
|------|----------|
| æ•°æ®åº“ | å­˜ UTC æ—¶é—´ï¼ˆtimestamp without time zoneï¼‰ |
| åç«¯ JVM | é»˜è®¤æ—¶åŒºç»Ÿä¸€ä¸º UTC |
| Jackson | ç»Ÿä¸€é…ç½® time-zone å’Œæ—¥æœŸæ ¼å¼ |
| å‰ç«¯ | æŒ‰ç”¨æˆ·æ—¶åŒºæœ¬åœ°åŒ–å±•ç¤ºæ—¶é—´ |
```

---

å¦‚æœä½ æ¥ä¸‹æ¥æƒ³ç»§ç»­ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

* æŠŠâ€œé‡‘é¢ä¸¤ä½å°æ•° + è„±æ• + æ—¶é—´ç»Ÿä¸€â€æ•´ç†æˆä¸€ç¯‡ **ã€ŠJSON & æ—¶é—´ & å®‰å…¨ åºåˆ—åŒ–è§„èŒƒã€‹**
* æˆ–è€…æˆ‘å¸®ä½ åŸºäº **Cangqiongwaimai** ä»“åº“å®é™…ç›®å½•å†™ä¸€ä»½å®Œæ•´çš„ `JSON è§„èŒƒ + å¼‚å¸¸è§„èŒƒ` æ–‡æ¡£ï¼Œç›´æ¥å½“é¡¹ç›®æ€»ç»“ç”¨ã€‚
